<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <link rel="stylesheet" href="./style/custom.css" />
        <link rel="icon" type="image/x-icon" href="./assets/favicon.ico" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Portf√®lio</title>
    </head>
    <body>
        <!-- Loading screen with typing effect -->
        <div class="loader">
            <div class="typing-container">
                <h1 class="typing-text"></h1>
            </div>
        </div>

        <img
            class="image-gradient"
            src="assets/Gradient from 3D Startup App.png"
            alt="Gradient"
        />
        <div class="layer-blur"></div>
        <div class="container">
            <header>
                <h1 class="logo">Portf√®lio</h1>

                <nav>
                    <a href="#">company</a>
                    <a href="#">features</a>
                    <a href="#">resources</a>
                    <a href="#">docs</a>
                </nav>
                <button class="btn-signing">signing</button>
            </header>

            <main>
                <div class="content">
                    <!-- <div class="tag-box">
                        <div class="tag">intrucing &wedbar;</div>
                    </div> -->

                    <h1>
                        Narendra<br />
                        Samtani
                    </h1>
                    <p class="discription">
                        I'm a chill-minded developer who vibes with clean code,
                        bold ideas, and late-night debugging sessions. I don't
                        just build websites ‚Äî I craft digital experiences that
                        feel smooth, smart, and alive.
                    </p>
                    <div class="buttons">
                        <div class="tag-box">
                            <div class="tag">intrucing &wedbar;</div>
                        </div>
                        <!-- <a href="#" class="btn-get-started"
                            >documentation &gt;</a
                        > -->
                        <!-- <a href="#" class="btn-signing-main">getstart &gt;</a> -->
                    </div>
                </div>
            </main>
            <spline-viewer
                class="robot-3d"
                url="https://prod.spline.design/CwijbN56EKGHUetz/scene.splinecode"
            ></spline-viewer>
            <!-- Add buttons somewhere in the corner (e.g., top-right) -->
            <!-- <button id="sound-toggle">üîä Stop</button> -->
            <div class="musiccontainer">
                <div class="music-control-container">
                    <!-- Equalizer bars -->
                    <div id="equalizer" class="equalizer">
                        <div class="eq-bar"></div>
                        <div class="eq-bar"></div>
                        <div class="eq-bar"></div>
                        <div class="eq-bar"></div>
                        <div class="eq-bar"></div>
                        <div class="eq-bar"></div>
                        <div class="eq-bar"></div>
                        <div class="eq-bar"></div>
                        <div class="eq-bar"></div>
                        <div class="eq-bar"></div>
                        <div class="eq-bar"></div>
                        <div class="eq-bar"></div>
                        <div class="eq-bar"></div>
                        <div class="eq-bar"></div>
                        <div class="eq-bar"></div>
                        <div class="eq-bar"></div>
                        <div class="eq-bar"></div>
                        <div class="eq-bar"></div>
                        <div class="eq-bar"></div>
                        <div class="eq-bar"></div>
                        <div class="eq-bar"></div>
                        <div class="eq-bar"></div>
                        <div class="eq-bar"></div>
                        <div class="eq-bar"></div>
                    </div>

                    <!-- Play/Pause button -->
                    <button id="sound-toggle" class="sound-button">
                        <span id="sound-icon" class="sound-icon">‚ñ∂Ô∏è</span>
                    </button>
                </div>
            </div>
        </div>
        <script
            type="module"
            src="https://unpkg.com/@splinetool/viewer@1.9.96/build/spline-viewer.js"
        ></script>

        <script>
            document.addEventListener("DOMContentLoaded", function () {
                const textElement = document.querySelector(".typing-text");
                const typingContainer =
                    document.querySelector(".typing-container");
                const loader = document.querySelector(".loader");
                const mainBody = document.querySelector("body");
                const mainContent = document.querySelector(".container");

                // Hide main content initially while keeping loader visible
                mainContent.style.display = "none";

                // The text to be typed
                const textToType = "Welcome to my Portf√®lio...";
                let charIndex = 0;

                // Function for typing effect
                function typeText() {
                    if (charIndex < textToType.length) {
                        textElement.textContent += textToType.charAt(charIndex);
                        charIndex++;
                        setTimeout(typeText, 100); // Adjust speed of typing here
                    } else {
                        // Highlight the word "Portf√®lio" by adding a span around it
                        const highlightedText = textElement.textContent.replace(
                            "Portf√®lio",
                            '<span class="highlight">Portf√®lio</span>'
                        );
                        textElement.innerHTML = highlightedText;

                        // When typing is complete, start the zoom effect after a pause
                        setTimeout(zoomAndTransition, 800);
                    }
                }

                // Function for zoom and transition effects
                function zoomAndTransition() {
                    // Start zoom effect - more subtle and natural
                    typingContainer.style.transform = "scale(8)";
                    typingContainer.style.opacity = "0.6";

                    // Fade out the loader more gradually
                    setTimeout(() => {
                        loader.style.opacity = "0";

                        // Show the main content
                        setTimeout(() => {
                            // Show the main content
                            mainContent.style.display = "block";

                            // Remove the loader after transition completes
                            setTimeout(() => {
                                loader.style.display = "none";
                            }, 500);
                        }, 800);
                    }, 1200);
                }

                // Start the typing effect
                setTimeout(typeText, 500);
            });

            document.addEventListener("DOMContentLoaded", () => {
                // Elements
                const soundToggle = document.getElementById("sound-toggle");
                const soundIcon = document.getElementById("sound-icon");
                const equalizer = document.getElementById("equalizer");
                const statusMessage = document.getElementById("status-message");
                const autoplayMessage =
                    document.getElementById("autoplay-message");
                const volumeSlider = document.getElementById("volume");

                // Create audio element for background music
                const backgroundMusic = new Audio();
                // backgroundMusic.src =
                //     "https://assets.mixkit.co/music/preview/mixkit-spirit-of-the-forest-547.mp3"; // Placeholder music URL
                backgroundMusic.src = "./sound/Lofi Background Music.mp3";
                backgroundMusic.loop = true;
                backgroundMusic.volume = 0.5; // Default volume

                // Function to update UI based on playback state
                function updatePlaybackUI(isPlaying) {
                    if (isPlaying) {
                        soundIcon.textContent = "‚è∏Ô∏è";
                        equalizer.classList.add("active");
                        statusMessage.textContent = "Now playing";
                    } else {
                        soundIcon.textContent = "‚ñ∂Ô∏è";
                        equalizer.classList.remove("active");
                        statusMessage.textContent = "Music paused";
                    }
                }

                // Check if browser supports autoplay with sound
                let autoplayAllowed = false;

                // Attempt to play silently to check if autoplay is allowed
                function checkAutoplaySupport() {
                    // Create a temporary audio element
                    const tempAudio = new Audio();
                    tempAudio.volume = 0;
                    tempAudio.src =
                        "data:audio/mpeg;base64,SUQzBAAAAAABEVRYWFgAAAAtAAADY29tbWVudABCaWdTb3VuZEJhbmsuY29tIC8gTGFTb25vdGhlcXVlLm9yZwBURU5DAAAAHQAAA1N3aXRjaCBQbHVzIMKpIE5DSCBTb2Z0d2FyZQBUSVQyAAAABgAAAzIyMzUAVFNTRQAAAA8AAANMYXZmNTcuODMuMTAwAAAAAAAAAAAAAAD/80DEAAAAA0gAAAAATEFNRTMuMTAwVVVVVVVVVVVVVUxBTUUzLjEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVf/zQsRbAAADSAAAAABVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVf/zQMSkAAADSAAAAABVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV";

                    // Try to play it - if it works, autoplay is supported
                    const playPromise = tempAudio.play();

                    if (playPromise !== undefined) {
                        playPromise
                            .then(() => {
                                // Autoplay is allowed
                                autoplayAllowed = true;
                                tempAudio.pause();
                                console.log("Autoplay is allowed");

                                // Now try to play the actual background music
                                startBackgroundMusic();
                            })
                            .catch((error) => {
                                // Autoplay is not allowed
                                autoplayAllowed = false;
                                console.log("Autoplay is not allowed:", error);

                                // Show message to the user
                                autoplayMessage.style.display = "block";
                            });
                    }
                }

                // Function to start background music
                function startBackgroundMusic() {
                    const playPromise = backgroundMusic.play();

                    if (playPromise !== undefined) {
                        playPromise
                            .then(() => {
                                // Music started playing successfully
                                updatePlaybackUI(true);
                            })
                            .catch((error) => {
                                // Autoplay was prevented
                                console.warn(
                                    "Background music autoplay was prevented:",
                                    error
                                );
                                updatePlaybackUI(false);
                                autoplayMessage.style.display = "block";
                            });
                    }
                }

                // Initialize by checking autoplay support when the page loads
                window.addEventListener("load", checkAutoplaySupport);

                // Listen for the first user interaction to try playing again if autoplay failed
                const userInteractionEvents = [
                    "click",
                    "touchstart",
                    "keydown",
                ];

                function handleFirstUserInteraction() {
                    if (backgroundMusic.paused) {
                        startBackgroundMusic();
                    }

                    // Remove the event listeners after first interaction
                    userInteractionEvents.forEach((event) => {
                        document.removeEventListener(
                            event,
                            handleFirstUserInteraction
                        );
                    });
                }

                // Add event listeners for the first user interaction
                userInteractionEvents.forEach((event) => {
                    document.addEventListener(
                        event,
                        handleFirstUserInteraction,
                        { once: true }
                    );
                });

                // Toggle button click handler
                soundToggle.addEventListener("click", () => {
                    if (backgroundMusic.paused) {
                        // Start playing
                        backgroundMusic
                            .play()
                            .then(() => {
                                updatePlaybackUI(true);
                                autoplayMessage.style.display = "none";
                            })
                            .catch((error) => {
                                console.error("Error playing music:", error);
                            });
                    } else {
                        // Pause playing
                        backgroundMusic.pause();
                        updatePlaybackUI(false);
                    }
                });

                // Volume control
                volumeSlider.addEventListener("input", () => {
                    backgroundMusic.volume = volumeSlider.value;
                });

                // Update UI when audio starts playing
                backgroundMusic.addEventListener("play", () => {
                    updatePlaybackUI(true);
                });

                // Update UI when audio is paused
                backgroundMusic.addEventListener("pause", () => {
                    updatePlaybackUI(false);
                });

                // Check if there are any issues with loading the audio
                backgroundMusic.addEventListener("error", (e) => {
                    console.error("Audio error:", e);
                    statusMessage.textContent = "Error loading audio";
                    autoplayMessage.textContent =
                        "There was an error loading the audio file. Please check your connection.";
                    autoplayMessage.style.display = "block";
                });
            });

            // Replace the placeholder URL with your actual audio file path
            // For a real implementation, update this line:
            // backgroundMusic.src = "sound/Lofi Background Music.mp3";
        </script>
    </body>
</html>
